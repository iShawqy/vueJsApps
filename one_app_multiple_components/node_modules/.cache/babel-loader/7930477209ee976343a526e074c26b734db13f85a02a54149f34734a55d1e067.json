{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, vModelSelect as _vModelSelect, withDirectives as _withDirectives, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createBlock as _createBlock, createVNode as _createVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-49862d8e\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"mainAppContainer\"\n};\nconst _hoisted_2 = {\n  class: \"homeViewContainer\"\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"homeView\"\n};\nconst _hoisted_4 = {\n  class: \"labelSelectContainer\"\n};\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  class: \"label\",\n  for: \"comboBox\"\n}, \"Who are you?\", -1 /* HOISTED */));\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"option\", {\n  disabled: \"\",\n  value: \"\"\n}, \"Please select who you are\", -1 /* HOISTED */));\nconst _hoisted_7 = {\n  class: \"labelSelectContainer\"\n};\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  class: \"label\",\n  for: \"comboBox1\"\n}, \"Chat with:\", -1 /* HOISTED */));\nconst _hoisted_9 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"option\", {\n  disabled: \"\",\n  value: \"\"\n}, \"Please select who you want to chat with\", -1 /* HOISTED */));\nconst _hoisted_10 = {\n  key: 0,\n  class: \"chatViewContainer\"\n};\nconst _hoisted_11 = {\n  class: \"inputArea\"\n};\nconst _hoisted_12 = [\"src\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_chat_head = _resolveComponent(\"chat-head\");\n  const _component_chat_area = _resolveComponent(\"chat-area\");\n  const _component_message_input_area = _resolveComponent(\"message-input-area\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [!$data.ready ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_hoisted_5, _withDirectives(_createElementVNode(\"select\", {\n    class: \"selectStyle\",\n    id: \"comboBox\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.chatterName = $event),\n    onChange: _cache[1] || (_cache[1] = $event => $options.selectChatter($event))\n  }, [_hoisted_6, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.users, user => {\n    return _openBlock(), _createElementBlock(\"option\", null, _toDisplayString(user.name), 1 /* TEXT */);\n  }), 256 /* UNKEYED_FRAGMENT */))], 544 /* HYDRATE_EVENTS, NEED_PATCH */), [[_vModelSelect, $data.chatterName]])]), _createElementVNode(\"div\", _hoisted_7, [_hoisted_8, _withDirectives(_createElementVNode(\"select\", {\n    class: \"selectStyle\",\n    id: \"comboBox1\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.chatteeName = $event),\n    onChange: _cache[3] || (_cache[3] = $event => $options.selectChattee($event))\n  }, [_hoisted_9, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.chattees, chatteeUser => {\n    return _openBlock(), _createElementBlock(\"option\", null, _toDisplayString(chatteeUser.name), 1 /* TEXT */);\n  }), 256 /* UNKEYED_FRAGMENT */))], 544 /* HYDRATE_EVENTS, NEED_PATCH */), [[_vModelSelect, $data.chatteeName]])])])) : _createCommentVNode(\"v-if\", true)]), $data.ready ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [$data.ready ? (_openBlock(), _createBlock(_component_chat_head, {\n    key: 0,\n    chattee: $data.chatteeName,\n    status: $data.chattee.status\n  }, null, 8 /* PROPS */, [\"chattee\", \"status\"])) : _createCommentVNode(\"v-if\", true), _createVNode(_component_chat_area, {\n    messages: $data.messages,\n    chatterName: $data.chatterName,\n    chatteeName: $data.chatteeName,\n    ref: \"refChatArea\"\n  }, null, 8 /* PROPS */, [\"messages\", \"chatterName\", \"chatteeName\"]), _createElementVNode(\"div\", _hoisted_11, [_createVNode(_component_message_input_area, {\n    chatter: $data.chatter,\n    chattee: $data.chattee,\n    ref: \"msgInputArea\"\n  }, null, 8 /* PROPS */, [\"chatter\", \"chattee\"]), $data.ready ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    class: \"BtnStyle btnGreen\",\n    onClick: _cache[4] || (_cache[4] = (...args) => $options.sendMessage && $options.sendMessage(...args))\n  }, \" Send \")) : _createCommentVNode(\"v-if\", true)])])) : _createCommentVNode(\"v-if\", true), $data.ready ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 1,\n    class: \"BtnStyle btnRed\",\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.logOut && $options.logOut(...args))\n  }, \" Log-out \")) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", null, [_createElementVNode(\"img\", {\n    src: $data.logo\n  }, null, 8 /* PROPS */, _hoisted_12)])]);\n}","map":{"version":3,"mappings":";;;EACKA,KAAK,EAAC;AAAkB;;EACtBA,KAAK,EAAC;AAAmB;;;EACvBA,KAAK,EAAC;;;EACRA,KAAK,EAAC;AAAsB;gEAC7BC,oBAAwD;EAAjDD,KAAK,EAAC,OAAO;EAACE,GAAG,EAAC;GAAW,cAAY;gEAGpDD,oBAA4D;EAApDE,QAAQ,EAAR,EAAQ;EAACC,KAAK,EAAC;GAAG,2BAAyB;;EAM9CJ,KAAK,EAAC;AAAsB;gEAC7BC,oBAAuD;EAAhDD,KAAK,EAAC,OAAO;EAACE,GAAG,EAAC;GAAY,YAAU;gEAGnDD,oBAA0E;EAAlEE,QAAQ,EAAR,EAAQ;EAACC,KAAK,EAAC;GAAG,yCAAuC;;;EAQ5DJ,KAAK,EAAC;;;EASJA,KAAK,EAAC;AAAW;;;;;;uBAlC1BK,oBAqDM,OArDNC,UAqDM,GApDJL,oBAsBM,OAtBNM,UAsBM,IArByBC,WAAK,kBAAlCH,oBAoBE,OApBFI,UAoBE,GAnBJR,oBAQQ,OARRS,UAQQ,GAPJC,UAAwD,kBAC5DV,oBAIO;IAJED,KAAK,EAAC,aAAa;IAACY,EAAE,EAAC,UAAU;+DAAUJ,iBAAW;IACrDK,QAAM,sCAAEC,sBAAa,CAACC,MAAM;MACtCC,UAA4D,qBAC5DX,oBAAqDY,6BAA7BT,WAAK,EAAbU,IAAI;yBAApBb,oBAAqD,iCAApBa,IAAI,CAACC,IAAI;6FAHUX,iBAAW,OAQ/DP,oBAQQ,OARRmB,UAQQ,GAPJC,UAAuD,kBAC3DpB,oBAIO;IAJED,KAAK,EAAC,aAAa;IAACY,EAAE,EAAC,WAAW;+DAAUJ,iBAAW;IAC/DK,QAAM,sCAAEC,sBAAa,CAACC,MAAM;MAC7BO,UAA0E,qBAC1EjB,oBAAsEY,6BAAvCT,cAAQ,EAAvBe,WAAW;yBAA3BlB,oBAAsE,iCAA3BkB,WAAW,CAACJ,IAAI;6FAHNX,iBAAW,gDAU3BA,WAAK,kBAA1CH,oBAoBM,OApBNmB,WAoBM,GAnB6DhB,WAAK,kBAAtEiB,aACYC;;IADAC,OAAO,EAAEnB,iBAAW;IAAGoB,MAAM,EAAEpB,aAAO,CAACoB;uFAEnDC,aAKaC;IALDC,QAAQ,EAAEvB,cAAQ;IAClBwB,WAAW,EAAExB,iBAAW;IACxByB,WAAW,EAAEzB,iBAAW;IACzB0B,GAAG,EAAC;uEAGfjC,oBAMM,OANNkC,WAMM,GALJN,aAAkGO;IAA7EC,OAAO,EAAE7B,aAAO;IAAGmB,OAAO,EAAEnB,aAAO;IAAE0B,GAAG,EAAC;mDACtB1B,WAAK,kBAA7CH,oBAEO;;IAFCL,KAAK,EAAC,mBAAmB;IAAesC,OAAK,yCAAExB,qDAAW;KAAE,QAEtE,iFAQoCN,WAAK,kBAA3CH,oBAEW;;IAFHL,KAAK,EAAC,iBAAiB;IAAesC,OAAK,yCAAExB,2CAAM;KAAE,WAE3D,wCACFb,oBAEQ,cADFA,oBAAiB;IAAXsC,GAAG,EAAE/B;EAAI","names":["class","_createElementVNode","for","disabled","value","_createElementBlock","_hoisted_1","_hoisted_2","$data","_hoisted_3","_hoisted_4","_hoisted_5","id","onChange","$options","$event","_hoisted_6","_Fragment","user","name","_hoisted_7","_hoisted_8","_hoisted_9","chatteeUser","_hoisted_10","_createBlock","_component_chat_head","chattee","status","_createVNode","_component_chat_area","messages","chatterName","chatteeName","ref","_hoisted_11","_component_message_input_area","chatter","onClick","src"],"sourceRoot":"","sources":["/Users/ihm/myDrive/private/git_vuejs_apps/one_app_multiple_components/src/components/chattingApp/mainChattingApp.vue"],"sourcesContent":["<template>\n<div class=\"mainAppContainer\">\n  <div class=\"homeViewContainer\">\n    <div class=\"homeView\" v-if=\"!ready\">\n  <div class=\"labelSelectContainer\">\n      <label class=\"label\" for=\"comboBox\">Who are you?</label>\n  <select  class=\"selectStyle\" id=\"comboBox\" v-model=\"chatterName\"\n           @change=\"selectChatter($event)\">\n  <option disabled value=\"\">Please select who you are</option>\n  <option  v-for=\"user in users\">{{user.name}}</option>\n</select>\n\n    </div>\n\n  <div class=\"labelSelectContainer\">\n      <label class=\"label\" for=\"comboBox1\">Chat with:</label>\n  <select  class=\"selectStyle\" id=\"comboBox1\" v-model=\"chatteeName\"\n  @change=\"selectChattee($event)\">\n  <option disabled value=\"\">Please select who you want to chat with</option>\n  <option  v-for=\"chatteeUser in chattees\">{{chatteeUser.name}}</option>\n</select>\n\n    </div>\n</div>\n  </div>\n\n  <div class=\"chatViewContainer\" v-if=\"ready\">\n    <chat-head :chattee=\"chatteeName\" :status=\"chattee.status\" v-if=\"ready\">\n    </chat-head>\n    <chat-area :messages=\"messages\"\n               :chatterName=\"chatterName\"\n               :chatteeName=\"chatteeName\"\n               ref=\"refChatArea\"\n\n    ></chat-area>\n    <div class=\"inputArea\">\n      <message-input-area :chatter=\"chatter\" :chattee=\"chattee\" ref=\"msgInputArea\"></message-input-area>\n      <button class=\"BtnStyle btnGreen\" v-if=\"ready\" @click=\"sendMessage\">\n      Send\n    </button>\n\n    </div>\n\n\n\n\n  </div>\n  <button class=\"BtnStyle btnRed\" v-if=\"ready\" @click=\"logOut\">\n      Log-out\n    </button>\n  <div >\n        <img :src=\"logo\">\n    </div>\n\n</div>\n\n\n</template>\n\n<script>\nimport axios from \"axios\";\nimport chatHead from \"@/components/chattingApp/chatHead\";\nimport chatArea from \"@/components/chattingApp/chatArea\";\nimport messageInputArea from \"@/components/chattingApp/messageInputArea\";\n\n\nexport default {\nname: \"mainChattingApp\",\ncomponents: {chatHead, chatArea, messageInputArea},\nmounted () {\n  this.fetchUsers();\n  this.createChatters();\n  // this.fetchMessages();\n  setInterval(this.fetchLatestMessages, 250);\n  setInterval(this.updateChatteeStatus, 500);\n\n\n},\ndata(){\n  return {\n    users: [],\n    chatterName: '',\n    chatter: {},\n    chatteeName: '',\n    chattee: {},\n    chatters: [],\n    chattees: [],\n    ready: false,\n    usersUrl: \"http://localhost:3004/users\",\n    messagesUrl: \"http://localhost:3004/messages\",\n    messages: [],\n    lastMessageId: 0,\n    newMessages: false,\n    chatStarted: false,\n    logo: \"logo.png\",\n  }\n},\nmethods: {\n  fetchUsers(){\n    axios.get(this.usersUrl)\n    .then(response => {\n      this.users = response.data;\n      this.createChatters();\n    })\n    .catch( error => {\n      console.log(error)\n    })\n  },\n  // fetchMessages(){\n  //   axios.get(this.messagesUrl)\n  //   .then(response => {\n  //     this.messages = response.data;\n  //     this.createChatters();\n  //\n  //   })\n  //   .catch( error => {\n  //     console.log(error)\n  //   })\n  // },\n  fetchLatestMessages(){\n    if (this.chatStarted) {\n      axios.get(this.messagesUrl)\n    .then(response => {\n      var recievedMsgs = response.data;\n      var filteredMsgs = [];\n      for (let i=0; i<recievedMsgs.length; i++){\n        if (recievedMsgs[i].creator == this.chatterName && recievedMsgs[i].destination == this.chatteeName){\n          filteredMsgs.push(recievedMsgs[i])\n        } else if (recievedMsgs[i].creator == this.chatteeName && recievedMsgs[i].destination == this.chatterName){\n          filteredMsgs.push(recievedMsgs[i])\n        }\n      }\n      this.messages = filteredMsgs;\n      for (let i=0; i<this.messages.length; i++) {\n        if (this.messages[i].id > this.lastMessageId) {\n          this.newMessages = true;\n          this.lastMessageId = this.messages[i].id\n\n        }\n      }\n      if (this.newMessages){\n         this.$refs.refChatArea.scrollToLastMessage(this.lastMessageId);\n         this.newMessages = false;\n      }\n\n\n\n\n    })\n    .catch( error => {\n      console.log(error)\n    })\n    }\n\n  },\n  createChatters(){\n\n    this.chatters = [];\n    for (let i=0; i<this.users.length; i++) {\n      this.chatters.push(this.users[i]);\n    }\n  },\n  selectChattee(event){\n    for (let i=0; i<this.users.length; i++) {\n      if (this.users[i].name == this.chatteeName) {\n        this.chattee = this.users[i];\n      }\n    }\n\n    this.startChat();\n\n  },\n  selectChatter(event){\n    for (let i=0; i<this.users.length; i++) {\n      if (this.users[i].name == this.chatterName) {\n        this.chatter = this.users[i];\n      }\n    }\n    this.updateChattersChatteesLists();\n  },\n  updateChattersChatteesLists(){\n    this.chattees = [];\n    for (let i=0; i<this.users.length; i++) {\n      if (this.users[i].name != this.chatterName) {\n        this.chattees.push(this.users[i]);\n      }\n\n    }\n  },\n  startChat(){\n    this.chatter.status = 'Online'\n    axios({\n        method: 'put',\n        url:this.usersUrl + '/' + this.chatter.id,\n        data: this.chatter\n      })\n      .then(response => {\n\n        this.$toast.success('You are online',  {\n        position: \"bottom\"})\n      })\n\n      .catch(error => {\n\n        this.$toast.error('Error while logging you in', {\n        position: \"bottom\"});\n      })\n    this.ready=true;\n    this.chatStarted = true;\n  },\n  logOut(){\n    this.chatter.status = 'Offline'\n    axios({\n        method: 'put',\n        url:this.usersUrl + '/' + this.chatter.id,\n        data: this.chatter\n      })\n      .then(response => {\n\n        this.$toast.success('You are Offline',  {\n        position: \"bottom\"})\n      })\n      .catch(error => {\n\n        this.$toast.error('Error while logging you in', {\n        position: \"bottom\"});\n      })\n    this.reset();\n\n  },\n  reset(){\n    this.users = [];\n    this.chatterName = '';\n    this.chatter = {};\n    this.chatteeName = '';\n    this.chattee = {};\n    this.chatters = [];\n    this.chattees = [];\n    this.ready =  false;\n    this.chatStarted = false;\n    this.lastMessageId = 0;\n    this.newMessages = false;\n    this.fetchUsers();\n    // this.fetchMessages();\n    this.createChatters();\n  },\n  sendMessage(){\n    this.$refs.msgInputArea.sendMessage();\n  },\n  updateChatteeStatus(){\n    if (this.chatStarted){\n      axios.get(this.usersUrl+'/'+this.chattee.id)\n    .then(response => {\n      console.log(response.data.status)\n      this.chattee.status = response.data.status;\n    })\n    .catch( error => {\n      console.log(error)\n    })\n    }\n\n  }\n}\n}\n</script>\n\n<style scoped>\n\n\n.mainAppContainer{\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: #152129;\n}\n.homeViewContainer{\n  display: flex;\n  width: fit-content;\n  height: fit-content;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  /*background-color: black;*/\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n  transform: translate(-50%, -50%);\n\n}\n\n.chatViewContainer{\n  display: flex;\n  width: 80vw;\n  height: 80vh;\n  min-width: 600px;\n  min-height: 600px;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  background-color: rgb(32,44,51);\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n  transform: translate(-50%, -50%);\n  border-radius: 10px;\n}\n\n\n\n.homeView{\n  display: flex;\n  width: fit-content;\n  height: fit-content;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  background-color: #176b5b;\n  border-radius: 10px;\n  color: white;\n\n}\n\n.labelSelectContainer{\n  display: flex;\n  width: 800px;\n  height: fit-content;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n\n.label{\n  font-size: 20px;\n  font-family: Arial;\n  margin-top: 5px;\n  margin-bottom: 5px;\n  margin-left: 5px;\n  margin-right: 5px;\n}\n.selectStyle{\n  width: 350px;\n  height: 30px;\n  border-radius: 10px;\n  margin: 5px;\n  color: black;\n  border-color: green;\n   font-size: 16px;\n  font-family: Arial;\n}\n\n.BtnStyle{\n  height: 30px;\n  width: fit-content;\n  border-radius: 10px;\n  font-size: 20px;\n  font-family: Arial;\n  border: none;\n  text-align: center;\n  text-decoration: none;\n  opacity: 0.6;\n  transition: 0.3s;\n  margin: 5px;\n  color: white;\n}\n.BtnStyle:hover{\n  opacity: 1;\n\n}\n.btnRed{\n  background-color: #ff0000;\n}\n\n.btnGreen{\n  height: 90%;\n  background-color: #26c800;\n}\n\n.inputArea{\n  display: flex;\n  width: 100%;\n  height: fit-content;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}